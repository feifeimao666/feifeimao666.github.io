<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.0.2"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-day29_nginx/nginx" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/08/05/day29_nginx/nginx/" class="article-date">
  <time datetime="2020-08-05T07:55:38.000Z" itemprop="datePublished">2020-08-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h2><h3 id="centos-安装-nginx"><a href="#centos-安装-nginx" class="headerlink" title="centos 安装 nginx"></a>centos 安装 nginx</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/yum.repos.d/</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 编辑文件</span></span><br><span class="line">vim nginx.repo</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加如下内容</span></span><br><span class="line">[nginx-stable]</span><br><span class="line">name=nginx stable repo</span><br><span class="line">baseurl=http://nginx.org/packages/centos/$releasever/$basearch/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=1</span><br><span class="line">gpgkey=https://nginx.org/keys/nginx_signing.key</span><br><span class="line"></span><br><span class="line">[nginx-mainline]</span><br><span class="line">name=nginx mainline repo</span><br><span class="line">baseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=0</span><br><span class="line">gpgkey=https://nginx.org/keys/nginx_signing.key</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装</span></span><br><span class="line">yum install nginx -y</span><br></pre></td></tr></table></figure>

<h3 id="均衡负载"><a href="#均衡负载" class="headerlink" title="均衡负载"></a>均衡负载</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">配置两台服务器，weight代表权重，数字越大权重越大</span></span><br><span class="line">upstream aaa&#123; #aaa名字随意</span><br><span class="line">    server localhost:8081 weight=10;</span><br><span class="line">    server localhost:8099 weight=10;</span><br><span class="line">    ip_hash;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location / &#123;</span><br><span class="line">    proxy_pass http://aaa;  #反向代理，aaa与上面的aaa名字保持一致</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/08/05/day29_nginx/nginx/" data-id="ckdvnr2p8002xhv5d9ham42ep" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-day31_部署/发布文档" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/08/05/day31_%E9%83%A8%E7%BD%B2/%E5%8F%91%E5%B8%83%E6%96%87%E6%A1%A3/" class="article-date">
  <time datetime="2020-08-05T07:55:38.000Z" itemprop="datePublished">2020-08-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="部署文档"><a href="#部署文档" class="headerlink" title="部署文档"></a>部署文档</h2><h2 id="测试服务"><a href="#测试服务" class="headerlink" title="测试服务"></a>测试服务</h2><h3 id="更新前端代码"><a href="#更新前端代码" class="headerlink" title="更新前端代码"></a>更新前端代码</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 切换目录</span></span><br><span class="line">cd /root/html_project/scratch_html/</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 拉取代码</span></span><br><span class="line">git pull</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看分支</span></span><br><span class="line">git branch -a </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 切换分支</span></span><br><span class="line">git checkout 分支名(本地分支)</span><br><span class="line">git checkout -t 分支名(远程分支)</span><br></pre></td></tr></table></figure>

<h3 id="更新后台代码"><a href="#更新后台代码" class="headerlink" title="更新后台代码"></a>更新后台代码</h3><p>测试服务器使用docker容器运行java项目，所以需要登录容器才能执行操作</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看容器</span></span><br><span class="line">docker ps</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 登录容器</span></span><br><span class="line">docker exec -it 容器id bash</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 生效配置文件</span></span><br><span class="line">source /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 切换目录</span></span><br><span class="line">cd /root/java_projects/kidstar/</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 拉取代码</span></span><br><span class="line">git pull</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看分支</span></span><br><span class="line">git branch -a</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 切换分支</span></span><br><span class="line">git checkout 分支名(本地分支)</span><br><span class="line">git checkout -t 分支名(远程分支)</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 杀死正在运行的java进程</span></span><br><span class="line">ps -ef|grep java</span><br><span class="line">kill -9 进程id</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除原来的jar</span></span><br><span class="line">rm -rf guns-admin/target</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 切换目录</span></span><br><span class="line">cd guns-parent/</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重新打包</span></span><br><span class="line">mvn clean package -Dmaven.test.skip=true</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 切换目录</span></span><br><span class="line">cd ../guns-admin/target</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 后台形式启动java服务</span></span><br><span class="line">nohup java -jar jar包名 --spring.profiles.active=test</span><br></pre></td></tr></table></figure>

<h2 id="正式服务"><a href="#正式服务" class="headerlink" title="正式服务"></a>正式服务</h2><h3 id="更新前端代码-1"><a href="#更新前端代码-1" class="headerlink" title="更新前端代码"></a>更新前端代码</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 切换目录</span></span><br><span class="line">cd /root/html_project/scratch_html/</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 拉取代码</span></span><br><span class="line">git pull</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看分支</span></span><br><span class="line">git branch -a </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 切换分支</span></span><br><span class="line">git checkout 分支名(本地分支)</span><br><span class="line">git checkout -t 分支名(远程分支)</span><br></pre></td></tr></table></figure>

<h3 id="更新后台代码-1"><a href="#更新后台代码-1" class="headerlink" title="更新后台代码"></a>更新后台代码</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 切换目录</span></span><br><span class="line">cd /root/java_projects/kidstar/</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 拉取代码</span></span><br><span class="line">git pull</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看分支</span></span><br><span class="line">git branch -a</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 切换分支</span></span><br><span class="line">git checkout 分支名(本地分支)</span><br><span class="line">git checkout -t 分支名(远程分支)</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 杀死正在运行的java进程</span></span><br><span class="line">ps -ef|grep java</span><br><span class="line">kill -9 进程id</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除原来的jar</span></span><br><span class="line">rm -rf guns-admin/target</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 切换目录</span></span><br><span class="line">cd guns-parent/</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重新打包</span></span><br><span class="line">mvn clean package -Dmaven.test.skip=true</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 切换目录</span></span><br><span class="line">cd ../guns-admin/target</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 后台形式启动java服务</span></span><br><span class="line">nohup java -jar jar包名 --spring.profiles.active=produce</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/08/05/day31_%E9%83%A8%E7%BD%B2/%E5%8F%91%E5%B8%83%E6%96%87%E6%A1%A3/" data-id="ckdvnr2pa0032hv5dbi8v6rvs" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-day30_docker/docker" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/08/05/day30_docker/docker/" class="article-date">
  <time datetime="2020-08-05T07:55:38.000Z" itemprop="datePublished">2020-08-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="安装-docker"><a href="#安装-docker" class="headerlink" title="安装 docker"></a>安装 docker</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install -y docker # 安装docker</span><br><span class="line">service docker start # 启动docker</span><br></pre></td></tr></table></figure>

<h2 id="docker-加速器"><a href="#docker-加速器" class="headerlink" title="docker 加速器"></a>docker 加速器</h2><p>在配置文件 /etc/docker/daemon.json 中加入：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;registry-mirrors&quot;</span>: [<span class="string">&quot;https://docker.mirrors.ustc.edu.cn/&quot;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="重新启动-docker"><a href="#重新启动-docker" class="headerlink" title="重新启动 docker"></a>重新启动 docker</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service docker restart</span><br></pre></td></tr></table></figure>

<h2 id="拉取镜像"><a href="#拉取镜像" class="headerlink" title="拉取镜像"></a>拉取镜像</h2><p>例如从 docker 官方仓库拉取 mysql 的镜像，冒号后面是版本号，latest 是最新版本</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql:latest</span><br></pre></td></tr></table></figure>

<h2 id="查看镜像"><a href="#查看镜像" class="headerlink" title="查看镜像"></a>查看镜像</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>

<h2 id="启动容器"><a href="#启动容器" class="headerlink" title="启动容器"></a>启动容器</h2><p>-dit 后台运行，端口可以不写</p>
<ul>
<li>第一次运行容器</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -dit -p 3306:3306 -p 7001:7001 -v /root/code_source:/root/code_source --privileged docker.io/centos /usr/sbin/init</span><br></pre></td></tr></table></figure>

<ul>
<li>之后再次运行</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start 容器id</span><br></pre></td></tr></table></figure>

<h2 id="查看容器"><a href="#查看容器" class="headerlink" title="查看容器"></a>查看容器</h2><p>查看正在运行的容器 id</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker ps 查看正在运行的容器</span><br><span class="line">docker ps -a 查看全部容器</span><br></pre></td></tr></table></figure>

<h2 id="登录容器"><a href="#登录容器" class="headerlink" title="登录容器"></a>登录容器</h2><p>通过 exec 登录指定容器</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it 容器id bash</span><br></pre></td></tr></table></figure>

<h2 id="退出容器"><a href="#退出容器" class="headerlink" title="退出容器"></a>退出容器</h2><p>直接在容器中输入 exit，退出后容器继续运行</p>
<h2 id="停止容器"><a href="#停止容器" class="headerlink" title="停止容器"></a>停止容器</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop 容器id</span><br></pre></td></tr></table></figure>

<h2 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a>删除容器</h2><p>删除容器前必须保证停止对应的容器</p>
<p>docker rm 容器 id</p>
<p>docker rm <code>docker ps -a -q</code>删除全部容器 -a 是显示所有容器，无论是否正在运行，-q 是只显示容器 id</p>
<h2 id="将容器打包成新的镜像"><a href="#将容器打包成新的镜像" class="headerlink" title="将容器打包成新的镜像"></a>将容器打包成新的镜像</h2><h3 id="commit-方法"><a href="#commit-方法" class="headerlink" title="commit 方法"></a>commit 方法</h3><p>如果在容器中安装了新的软件，或者配置了新的环境变量等操作，在重启 docker 或者停止容器后，之前的操作将失效，要想下次继续使用新的软件和环境，就需要将容器打包成新的镜像，以便使用。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker commit 容器id 新的镜像名称</span><br></pre></td></tr></table></figure>

<h3 id="Dockerfile-方法"><a href="#Dockerfile-方法" class="headerlink" title="Dockerfile 方法"></a>Dockerfile 方法</h3><p>from 基础镜像<br>run 执行命令<br>add 添加文件<br>copy 拷贝文件<br>cmd 执行命令<br>expose 暴力端口<br>workdir 工作目录<br>maintainer 作者<br>env 环境变量<br>entrypoint 执行命令<br>user 用户<br>volume 卷</p>
<p>编写好的 Dockerfile，运行<code>docker build -t 新的镜像名称 .</code>生成新的镜像</p>
<h2 id="删除镜像"><a href="#删除镜像" class="headerlink" title="删除镜像"></a>删除镜像</h2><p>删除镜像前必须保证删除该镜像创建的容器</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rmi 镜像id</span><br></pre></td></tr></table></figure>

<h2 id="拷贝文件"><a href="#拷贝文件" class="headerlink" title="拷贝文件"></a>拷贝文件</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">从主机复制到容器</span></span><br><span class="line">docker cp host_path containerID:container_path</span><br><span class="line"><span class="meta">#</span><span class="bash">从容器复制到主机</span></span><br><span class="line">docker cp containerID:container_path host_path</span><br></pre></td></tr></table></figure>

<h2 id="volume-挂载"><a href="#volume-挂载" class="headerlink" title="volume 挂载"></a>volume 挂载</h2><p>方式一：将容器中的指定文件挂载到宿主机中</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 挂载/usr/share/nginx/html到宿主机</span></span><br><span class="line">docker run -v 容器中需要挂载的目录 容器id</span><br></pre></td></tr></table></figure>

<p>docker inspect 容器 id</p>
<p>查看容器在宿主机中 Mounts 实际对应的文件夹，然后在这个文件夹中添加修改内容，会同步到容器中去。</p>
<p>例如：Source 是实际在宿主机中的地址，Destination 是容器中的被挂载的文件夹，在 Source 添加修改文件，Destination 会同步，反之亦然。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&quot;Mounts&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">&quot;Type&quot;</span>: <span class="string">&quot;volume&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;Name&quot;</span>: <span class="string">&quot;798487841f4a4d6ab84686dde64bba4715a25d574a1e9f3e84e8c3b738aaa953&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;Source&quot;</span>: <span class="string">&quot;/var/lib/docker/volumes/798487841f4a4d6ab84686dde64bba4715a25d574a1e9f3e84e8c3b738aaa953/_data&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;Destination&quot;</span>: <span class="string">&quot;/root/.ssh&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;Driver&quot;</span>: <span class="string">&quot;local&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;Mode&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;RW&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">&quot;Propagation&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>方式二：将容器的文件挂载到宿主机的指定文件夹上</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 将当前目录下的html文件夹挂载到容器中的/usr/share/nginx/html目录下</span></span><br><span class="line">docker run -v 主机文件夹:容器中需要挂载的文件夹 容器id # 注意必须是绝对目录</span><br></pre></td></tr></table></figure>

<p>方式三：将一个容器中的文件夹挂载到另一个容器中</p>
<p>这样做的好处是可以把一个容器专门用来提供数据</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 创建一个容器</span></span><br><span class="line">docker create -v 主机文件夹:容器中需要挂载的文件夹 --name container_name image_name</span><br><span class="line"><span class="meta">#</span><span class="bash"> 以上面创建的容器为基础再创建一个容器，可以创建多个这样的容器</span></span><br><span class="line">docker run -dit --volumes-from container_name image_name bash</span><br><span class="line"><span class="meta">#</span><span class="bash"> 一旦主机文件发生改变，那么所有以container_name这个容器为基础的容器中被挂载的文件夹都会发生改变</span></span><br></pre></td></tr></table></figure>

<p>注意：<br>在 centos7 中，上面二、三种方式需要解决挂载文件的权限问题，有两种方法：<br>方法一：在 run 的时候添加参数<code>--privileged=true</code><br>方法二：在宿主机中修改挂载文件权限 <code>chcon -Rt svirt_sandbox_file_t 挂载文件目录</code></p>
<h2 id="registry-镜像仓库"><a href="#registry-镜像仓库" class="headerlink" title="registry 镜像仓库"></a>registry 镜像仓库</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 复制一个镜像，并重命名</span></span><br><span class="line">docker tag 久的镜像id 新的镜像id</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 推送镜像到官方hub</span></span><br><span class="line">docker login # 先登录</span><br><span class="line">docker push 镜像id:tag</span><br></pre></td></tr></table></figure>

<h2 id="镜像-push-和-pull"><a href="#镜像-push-和-pull" class="headerlink" title="镜像 push 和 pull"></a>镜像 push 和 pull</h2><h2 id="compose-资源编排"><a href="#compose-资源编排" class="headerlink" title="compose 资源编排"></a>compose 资源编排</h2><p>快速扩展 docker</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/08/05/day30_docker/docker/" data-id="ckdvnr2pb0036hv5d3sswf9ap" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-day32_react/react" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/01/21/day32_react/react/" class="article-date">
  <time datetime="2020-01-21T02:34:33.222Z" itemprop="datePublished">2020-01-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="react-项目"><a href="#react-项目" class="headerlink" title="react 项目"></a>react 项目</h1><h2 id="index-js"><a href="#index-js" class="headerlink" title="index.js"></a>index.js</h2><ul>
<li>导入 React、ReactDOM、BrowserRouter</li>
<li>导入 App 组件</li>
<li>导入 css</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">&quot;react-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; BrowserRouter &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">&quot;./App&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;./index.css&quot;</span>;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;BrowserRouter&gt;</span><br><span class="line">    &lt;App /&gt;</span><br><span class="line">  &lt;/BrowserRouter&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">&quot;root&quot;</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h2 id="App-jsx"><a href="#App-jsx" class="headerlink" title="App.jsx"></a>App.jsx</h2><ul>
<li>布局页面（可以使用 bootstrap.css）</li>
<li>使用<Switch>、<Route>、<Redirect>实现路由</li>
<li>路由顺序从上到下，模糊匹配，可以使用 exact 精确匹配</li>
<li>可以对路由组件包装，添加功能，例如<ProtectedRoute></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;Fragment&gt;</span><br><span class="line">  &lt;main className=<span class="string">&quot;container&quot;</span>&gt;</span><br><span class="line">    &lt;Switch&gt;</span><br><span class="line">      &lt;Route path=<span class="string">&quot;/login&quot;</span> exact component=&#123;LoginForm&#125; /&gt;</span><br><span class="line">      &lt;ProtectedRoute path=<span class="string">&quot;/movies/:id&quot;</span> exact component=&#123;MovieForm&#125; /&gt;</span><br><span class="line">      &lt;Route</span><br><span class="line">        path=<span class="string">&quot;/movies&quot;</span></span><br><span class="line">        render=&#123;<span class="function"><span class="params">props</span> =&gt;</span> <span class="xml"><span class="tag">&lt;<span class="name">Movies</span> &#123;<span class="attr">...props</span>&#125; <span class="attr">user</span>=<span class="string">&#123;user&#125;</span> /&gt;</span></span>&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;/Switch&gt;</span><br><span class="line">    &lt;Redirect to=<span class="string">&quot;/404&quot;</span> /&gt;</span><br><span class="line">  &lt;/main&gt;</span><br><span class="line">&lt;/Fragment&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Component"><a href="#Component" class="headerlink" title="Component"></a>Component</h2><ul>
<li>state={}存储数据，使用 this.state.xxx 获取数据，使用 this.setstate({})存储数据</li>
<li>componentDidMount()方法加载数据</li>
<li>使用自定义箭头函数处理数据</li>
<li>render()方法渲染页面数据</li>
<li>使用 props 传递数据，包括数据和方法（可以使用 jsx 语法的代码）</li>
<li>如果使用 react-router-dom，props 上代码有 location、history、match 属性</li>
<li>使用<Link>、history、window.location 来实现页面跳转</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//类组件，有state</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginForm</span> <span class="keyword">extends</span> <span class="title">Form</span> </span>&#123;</span><br><span class="line">  <span class="comment">//Form继承了Component</span></span><br><span class="line">  state = &#123;</span><br><span class="line">    data: &#123; <span class="attr">username</span>: <span class="string">&quot;&quot;</span>, <span class="attr">password</span>: <span class="string">&quot;&quot;</span> &#125;,</span><br><span class="line">    errors: &#123;&#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  schema = &#123;</span><br><span class="line">    username: Joi.string().required(),</span><br><span class="line">    password: Joi.string().required()</span><br><span class="line">  &#125;;</span><br><span class="line">  doSubmit = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; data &#125; = <span class="built_in">this</span>.state;</span><br><span class="line">      <span class="keyword">await</span> login(data.username, data.password);</span><br><span class="line">      <span class="keyword">const</span> &#123; state &#125; = <span class="built_in">this</span>.props.location;</span><br><span class="line">      <span class="built_in">window</span>.location = state ? state.from.pathname : <span class="string">&quot;/&quot;</span>; <span class="comment">//登录后，回到原来的页面</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="keyword">if</span> (error &amp;&amp; error.response.status === <span class="number">400</span>) &#123;</span><br><span class="line">        toast.error(<span class="string">&quot;用户名或者密码错误&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div className=<span class="string">&quot;main&quot;</span>&gt;</span><br><span class="line">        &lt;form onSubmit=&#123;<span class="built_in">this</span>.handleSubmit&#125;&gt;</span><br><span class="line">          &#123;<span class="built_in">this</span>.renderInput(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;邮箱&quot;</span>)&#125;</span><br><span class="line">          &#123;<span class="built_in">this</span>.renderInput(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;密码&quot;</span>, <span class="string">&quot;password&quot;</span>)&#125;</span><br><span class="line">          &#123;<span class="built_in">this</span>.renderButton(<span class="string">&quot;登录&quot;</span>)&#125;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> LoginForm;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//无状态组件，没有state</span></span><br><span class="line"><span class="comment">//props中的属性，尽量析构出来，清楚知道该组件的所有要传递的属性</span></span><br><span class="line"><span class="keyword">const</span> Input = <span class="function">(<span class="params">&#123; name, label, error, ...rest &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=<span class="string">&quot;form-group&quot;</span>&gt;</span><br><span class="line">      &lt;label htmlFor=&#123;name&#125;&gt;&#123;label&#125;&lt;/label&gt;</span><br><span class="line">      &lt;input &#123;...rest&#125; id=&#123;name&#125; name=&#123;name&#125; className=<span class="string">&quot;form-control&quot;</span> /&gt;</span><br><span class="line">      &#123;error &amp;&amp; <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;alert alert-danger&quot;</span>&gt;</span>&#123;error&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Input;</span><br></pre></td></tr></table></figure>

<h2 id="服务"><a href="#服务" class="headerlink" title="服务"></a>服务</h2><ul>
<li>提供服务接口，方便组件使用，也方便后期升级维护接口</li>
<li>其中 http 服务使用 axios，auth 服务使用 jwt、log 服务使用 sentry.io</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用sentry记录错误日志</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> Sentry <span class="keyword">from</span> <span class="string">&quot;@sentry/browser&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; toast &#125; <span class="keyword">from</span> <span class="string">&quot;react-toastify&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  Sentry.init(&#123;</span><br><span class="line">    dsn: <span class="string">&quot;https://437f2e91a488438fb9654e10c0f7296c@sentry.io/1887874&quot;</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">error, msg = null</span>) </span>&#123;</span><br><span class="line">  toast.error(<span class="string">&quot;出现一个未知错误：&quot;</span> + msg);</span><br><span class="line">  Sentry.captureException(error);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  init,</span><br><span class="line">  log</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="提示"><a href="#提示" class="headerlink" title="提示"></a>提示</h2><ul>
<li>使用 Joi 校验表单完整性</li>
<li>使用 react-toastify 弹出提示信息</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用Joi校验表单</span></span><br><span class="line">schema = &#123;</span><br><span class="line">  username: Joi.string().required(),</span><br><span class="line">  password: Joi.string().required()</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> options = &#123; <span class="attr">abortEarly</span>: <span class="literal">false</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> &#123; error &#125; = Joi.validate(<span class="built_in">this</span>.state.data, <span class="built_in">this</span>.schema, options);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ToastContainer &#125; <span class="keyword">from</span> <span class="string">&quot;react-toastify&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;react-toastify/dist/ReactToastify.css&quot;</span>;</span><br><span class="line">&lt;ToastContainer /&gt;;</span><br><span class="line"><span class="keyword">import</span> &#123; toast &#125; <span class="keyword">from</span> <span class="string">&quot;react-toastify&quot;</span>;</span><br><span class="line">toast.error(<span class="string">&quot;出现未知错误&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><ul>
<li>使用.env 和.env.development 配置环境，环境变量必须是 <code>REACT_APP_</code>开头，全部大写</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> apiUrl = process.env.REACT_APP_API;</span><br></pre></td></tr></table></figure>

<h2 id="组件封装"><a href="#组件封装" class="headerlink" title="组件封装"></a>组件封装</h2><ul>
<li>先写 HTML 代码</li>
<li>抽离可复用部分，封装成子组件，一般是无状态组件</li>
<li>封装的属性和方法命名尽量通用，例如：data、value、onChange 等等</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/01/21/day32_react/react/" data-id="ckdvnr2pc0038hv5d1uny2zw9" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-day28_es6/es6" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/03/26/day28_es6/es6/" class="article-date">
  <time datetime="2018-03-26T06:44:19.000Z" itemprop="datePublished">2018-03-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;    </span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> show=<span class="function">(<span class="params">a,b</span>)=&gt;</span>&#123;</span><br><span class="line">    a=a*<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//如果函数体只有一个return语句，可以简写</span></span><br><span class="line"><span class="keyword">let</span> show1=<span class="function">(<span class="params">a,b</span>)=&gt;</span>a+b;</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果只有一个参数的时候，可以不写括号</span></span><br><span class="line"><span class="keyword">let</span> show2=<span class="function"><span class="params">a</span>=&gt;</span>a*<span class="number">2</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="函数参数"><a href="#函数参数" class="headerlink" title="函数参数"></a>函数参数</h2><h3 id="参数扩展"><a href="#参数扩展" class="headerlink" title="参数扩展"></a>参数扩展</h3><p>…args，注意参数扩展必须是最后一个参数</p>
<ul>
<li>收集参数</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params">a,b,...args</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(a,b,args);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>展开数组</li>
</ul>
<p>直接写<code>...args</code>相当于直接将数组的内容写出来</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="built_in">console</span>.log(...arr);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr1=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> arr2=[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>];</span><br><span class="line"><span class="built_in">console</span>.log(...arr1,...arr2);</span><br></pre></td></tr></table></figure>

<h3 id="默认参数"><a href="#默认参数" class="headerlink" title="默认参数"></a>默认参数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params">a,b=<span class="number">10</span></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(a,b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="解构赋值"><a href="#解构赋值" class="headerlink" title="解构赋值"></a>解构赋值</h2><p>将结构相同的内容解开来，进行赋值</p>
<ul>
<li>左右两边的解构必须一样</li>
<li>右边必须是一个东西</li>
<li>声明和赋值必须在一起</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [a,b]=[<span class="number">1</span>,<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> json=&#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="string">&#x27;a&#x27;</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [json,num,arr]=[&#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="string">&#x27;a&#x27;</span>&#125;,<span class="number">100</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [&#123;a,b&#125;,num,[c,d,e]]=[&#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="string">&#x27;a&#x27;</span>&#125;,<span class="number">100</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]];</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a,b,c,d,e,num);</span><br></pre></td></tr></table></figure>

<h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><ul>
<li>map     映射：对数组中每个元素进行处理</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr=[<span class="number">140</span>,<span class="number">90</span>,<span class="number">85</span>,<span class="number">27</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> result=arr.map(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item*<span class="number">2</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> result=arr.map(<span class="function"><span class="params">item</span>=&gt;</span>item&gt;<span class="number">60</span>?<span class="string">&#x27;及格&#x27;</span>:<span class="string">&#x27;不及格&#x27;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>reduce  汇总：一堆数据进一个出</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr=[<span class="number">2</span>,<span class="number">3</span>,<span class="number">53</span>,<span class="number">63</span>,<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> result=arr.reduce(<span class="function">(<span class="params">tmp,item,index</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> tmp+item;<span class="comment">//tmp是每次处理的结果，在下一次处理时使用</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><img src="1.png"></p>
<ul>
<li>filter     过滤，true留下，false舍弃</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr=[<span class="number">2</span>,<span class="number">342</span>,<span class="number">53</span>,<span class="number">67</span>,<span class="number">7</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> result=arr.filter(<span class="function"><span class="params">item</span>=&gt;</span>item%<span class="number">3</span>==<span class="number">0</span>);<span class="comment">//保留能被3整除的数据</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr=[&#123;<span class="attr">name</span>:<span class="string">&#x27;男生包&#x27;</span>,<span class="attr">price</span>:<span class="number">90</span>&#125;,&#123;<span class="attr">name</span>:<span class="string">&#x27;男生鞋&#x27;</span>,<span class="attr">price</span>:<span class="number">200</span>&#125;,&#123;<span class="attr">name</span>:<span class="string">&#x27;女生包&#x27;</span>,<span class="attr">price</span>:<span class="number">10000</span>&#125;];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> result=arr.filter(<span class="function"><span class="params">json</span>=&gt;</span>json.price&gt;<span class="number">5000</span>);<span class="comment">//保留价格大于5000的json对象</span></span><br></pre></td></tr></table></figure>

<ul>
<li>forEach     迭代</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr=[<span class="number">2</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">arr.forEach(<span class="function">(<span class="params">item,index</span>)=&gt;</span>&#123;</span><br><span class="line">    conosle.log(index+<span class="string">&#x27;:&#x27;</span>+item);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="类与对象"><a href="#类与对象" class="headerlink" title="类与对象"></a>类与对象</h2><p>使用关键字class定义类，使用关键字extends实现继承，综合和java的语法非常相似。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="comment">//构造函数</span></span><br><span class="line">    <span class="keyword">constructor</span>(name,age)&#123;</span><br><span class="line">        <span class="built_in">this</span>.name=name;</span><br><span class="line">        <span class="built_in">this</span>.age=age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//方法</span></span><br><span class="line">    show()&#123;</span><br><span class="line">        alert(<span class="built_in">this</span>.name+<span class="string">&quot;:&quot;</span>+<span class="built_in">this</span>.age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;    </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VIPUser</span> <span class="keyword">extends</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name,age,level)&#123;</span><br><span class="line">        <span class="built_in">super</span>(name,age);</span><br><span class="line">        <span class="built_in">this</span>.level=level;</span><br><span class="line">    &#125;</span><br><span class="line">    show()&#123;</span><br><span class="line">        alert(<span class="built_in">this</span>.name+<span class="string">&quot;:&quot;</span>+<span class="built_in">this</span>.age+<span class="string">&quot;:&quot;</span>+<span class="built_in">this</span>.level);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> User(<span class="string">&quot;lisi&quot;</span>,<span class="number">20</span>);</span><br><span class="line">user.show();</span><br><span class="line"><span class="keyword">const</span> vipUser = <span class="keyword">new</span> VIPUser(<span class="string">&quot;zhangsan&quot;</span>,<span class="number">20</span>,<span class="number">1</span>);</span><br><span class="line">vipUser.show();</span><br></pre></td></tr></table></figure>

<h2 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h2><p>异步请求同步写法，适合在一次读取一堆数据的情况下使用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.all([</span><br><span class="line">        <span class="comment">//发送的异步请求，可以为多个</span></span><br><span class="line">        $.ajax(&#123;<span class="attr">url</span>:<span class="string">&#x27;/array.txt&#x27;</span>,<span class="attr">dataType</span>:<span class="string">&#x27;json&#x27;</span>&#125;),</span><br><span class="line">        $.ajax(&#123;<span class="attr">url</span>:<span class="string">&#x27;/json.txt&#x27;</span>,<span class="attr">dataType</span>:<span class="string">&#x27;json&#x27;</span>&#125;),</span><br><span class="line">    ]).then(<span class="function"><span class="params">data</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="comment">//全部请求成功后处理逻辑</span></span><br><span class="line">        <span class="built_in">console</span>.log(data);</span><br><span class="line">        alert(<span class="string">&#x27;success&#x27;</span>);</span><br><span class="line">    &#125;,<span class="function"><span class="params">err</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="comment">//只要有一个失败后处理逻辑</span></span><br><span class="line">        consolel.err(err);</span><br><span class="line">        alert(<span class="string">&#x27;failed&#x27;</span>);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

<h2 id="generator"><a href="#generator" class="headerlink" title="generator"></a>generator</h2><p>生成器，可以应用在带有逻辑的异步请求</p>
<p>yield后面的返回出去的异步请求数据，前面是传递进来的数据，供后面的逻辑使用，return是最终返回的数据</p>
<p>不能使用箭头函数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> * <span class="title">show</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> data1=<span class="keyword">yield</span> $.ajax(&#123;url;<span class="string">&#x27;xxxx&#x27;</span>&#125;)；</span><br><span class="line">    <span class="comment">//这里可有逻辑</span></span><br><span class="line">    <span class="keyword">let</span> data2=<span class="keyword">yield</span> $.ajax(&#123;url;<span class="string">&#x27;xxxx&#x27;</span>&#125;)；</span><br><span class="line">    <span class="comment">//这里可以有逻辑</span></span><br><span class="line">    <span class="keyword">let</span> data3=<span class="keyword">yield</span> $.ajax(&#123;url;<span class="string">&#x27;xxxx&#x27;</span>&#125;)；</span><br><span class="line">    <span class="built_in">console</span>.log(data1,data2,data3)；</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`最终数据：<span class="subst">$&#123;data3&#125;</span>`</span>；</span><br><span class="line">&#125;</span><br><span class="line">show();</span><br></pre></td></tr></table></figure>


<h2 id="async"><a href="#async" class="headerlink" title="async"></a>async</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> show=<span class="keyword">async</span> ()=&gt;&#123;</span><br><span class="line">    <span class="keyword">let</span> data1=<span class="keyword">await</span> $.ajax(&#123;url;<span class="string">&#x27;xxxx&#x27;</span>&#125;)；</span><br><span class="line">    <span class="comment">//这里可有逻辑</span></span><br><span class="line">    <span class="keyword">let</span> data2=<span class="keyword">await</span> $.ajax(&#123;url;<span class="string">&#x27;xxxx&#x27;</span>&#125;)；</span><br><span class="line">    <span class="comment">//这里可以有逻辑</span></span><br><span class="line">    <span class="keyword">let</span> data3=<span class="keyword">await</span> $.ajax(&#123;url;<span class="string">&#x27;xxxx&#x27;</span>&#125;)；</span><br><span class="line">    <span class="built_in">console</span>.log(data1,data2,data3)；</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`最终数据：<span class="subst">$&#123;data3&#125;</span>`</span>；</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">show();</span><br></pre></td></tr></table></figure>






      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/03/26/day28_es6/es6/" data-id="ckdvnr2p5002nhv5delap3ese" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-day11_shop/shop" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/17/day11_shop/shop/" class="article-date">
  <time datetime="2017-11-17T07:51:58.000Z" itemprop="datePublished">2017-11-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/java%E4%B8%AD%E7%BA%A7%E5%9F%BA%E7%A1%80/">java中级基础</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/17/day11_shop/shop/">shop项目</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="登录与注册"><a href="#登录与注册" class="headerlink" title="登录与注册"></a>登录与注册</h2><h2 id="获取所有商品"><a href="#获取所有商品" class="headerlink" title="获取所有商品"></a>获取所有商品</h2><p>步骤：</p>
<ul>
<li>1、GoodDao</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//选择商品列表</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Goods&gt; <span class="title">selectGoods</span><span class="params">(<span class="keyword">int</span> pageNum)</span> </span>&#123;</span><br><span class="line">    String sql = <span class="string">&quot;select g.*,t.typename from goods g inner join type t on g.typeid=t.typeid limit ?,?&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> JdbcUtils.selectAll(sql, Goods.class, (pageNum-<span class="number">1</span>)*Const.PAGE_SIZE,Const.PAGE_SIZE);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//分页的时候使用</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">selectCount</span><span class="params">(Goods goods)</span> </span>&#123;</span><br><span class="line">    String sql=<span class="string">&quot;select count(gid) from goods&quot;</span>;</span><br><span class="line">    <span class="comment">//可以通过Number解决不同数据库返回值类型不同的问题</span></span><br><span class="line">    <span class="keyword">return</span> ((Number)JdbcUtils.selectValue(sql)).intValue();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>2、GoodService</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Goods&gt; <span class="title">selectGoods</span><span class="params">(<span class="keyword">int</span> pageNum)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> goodsDao.selectGoods(pageNum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>3、 GoodServlet</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">list</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">    <span class="comment">//获取前端传递过来的当前页数</span></span><br><span class="line">    String pageNumStr = req.getParameter(<span class="string">&quot;pageNum&quot;</span>);</span><br><span class="line">    <span class="comment">//如果没有传递当前页数，默认为1</span></span><br><span class="line">    <span class="keyword">int</span> pageNum=<span class="number">1</span>;</span><br><span class="line">    <span class="comment">//如果有传递当前页数，则使用当前页数</span></span><br><span class="line">    <span class="keyword">if</span>(pageNumStr!=<span class="keyword">null</span>)&#123;</span><br><span class="line">        pageNum=Integer.parseInt(pageNumStr);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//根据当前页数获取商品列表信息</span></span><br><span class="line">    List&lt;Goods&gt; list = goodsService.selectGoods(pageNum);</span><br><span class="line">    <span class="comment">//获取中条数</span></span><br><span class="line">    <span class="keyword">int</span> total = goodsService.selectCount(<span class="keyword">null</span>);</span><br><span class="line">    <span class="comment">//将列表信息，总条数，总页数放到Page对象中</span></span><br><span class="line">    Page&lt;Goods&gt; page=<span class="keyword">new</span> Page&lt;Goods&gt;();</span><br><span class="line">    page.setList(list);<span class="comment">//商品列表信息</span></span><br><span class="line">    page.setTotal(total);<span class="comment">//总条数</span></span><br><span class="line">    page.setPageNum(pageNum);<span class="comment">//当前页数</span></span><br><span class="line">    <span class="comment">//将page对象放到request对象中</span></span><br><span class="line">    req.setAttribute(<span class="string">&quot;page&quot;</span>, page);</span><br><span class="line">    <span class="comment">//转发到list.jsp页面</span></span><br><span class="line">    req.getRequestDispatcher(<span class="string">&quot;/goods/list.jsp&quot;</span>).forward(req, resp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>4、goodlist.jsp</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>序号<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>商品名称<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>价格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>库存 <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>类别 <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">c:forEach</span> <span class="attr">items</span>=<span class="string">&quot;$&#123;page.list&#125;&quot;</span> <span class="attr">var</span>=<span class="string">&quot;goods&quot;</span> <span class="attr">varStatus</span>=<span class="string">&quot;i&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;i.count&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;goods.gname &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;goods.gprice &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;goods.count &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;goods.typename &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span>&gt;</span>详情<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">&quot;$&#123;user.username ==&#x27;admin&#x27; &#125;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">c:forEach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 分页 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;$&#123;ctx &#125;/goods?op=list&quot;</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">&quot;$&#123;page.pageNum&gt;1 &#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;$&#123;ctx&#125;/goods?op=list&amp;pageNum=$&#123;page.pageNum-1&#125;&quot;</span>&gt;</span>上一页<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">&quot;$&#123;page.pageNum&lt;page.pageTotal &#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;$&#123;ctx&#125;/goods?op=list&amp;pageNum=$&#123;page.pageNum+1&#125;&quot;</span>&gt;</span>下一页<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;$&#123;ctx&#125;/goods?op=list&amp;pageNum=$&#123;page.pageTotal&#125;&quot;</span>&gt;</span>末页<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">[$&#123;page.pageNum&#125;/$&#123;page.pageTotal&#125;]<span class="symbol">&amp;nbsp;</span>共$&#123;page.total&#125;条记录</span><br></pre></td></tr></table></figure>

<h2 id="添加到购物车"><a href="#添加到购物车" class="headerlink" title="添加到购物车"></a>添加到购物车</h2><p>思路：</p>
<p>1、创建一个监听器，ServletContextListenner</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ServletContext context = sce.getServletContext();</span><br><span class="line">Map&lt;Integer, List&lt;GoodDetail&gt;&gt; map=<span class="keyword">new</span> HashMap&lt;Integer, List&lt;GoodDetail&gt;&gt;();</span><br><span class="line">context.setAttribute(<span class="string">&quot;map&quot;</span>, map);</span><br></pre></td></tr></table></figure>

<p>2、在该监听器中创建一个Map&lt;Integer, List<GoodDetail>&gt; map（key:uid,value:购物车），并且放到ServletContext域对象</p>
<p>3、在web.xml中注册监听器</p>
<p>4、创建一个类Detail，里面有两个属性：gid(商品编号),num(购买数量)</p>
<p><img src="http://oyirtj6m7.bkt.clouddn.com/17-11-17/16897056.jpg"></p>
<ul>
<li>list.jsp</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">c:forEach</span> <span class="attr">items</span>=<span class="string">&quot;$&#123;page.list&#125;&quot;</span> <span class="attr">var</span>=<span class="string">&quot;goods&quot;</span> <span class="attr">varStatus</span>=<span class="string">&quot;i&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;i.count&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;goods.gname &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;goods.gprice &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;goods.count &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;goods.typename &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">hidden</span>=<span class="string">&quot;hidden&quot;</span>&gt;</span>$&#123;goods.gid &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">required</span>=<span class="string">&quot;required&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span>&gt;</span>详情<span class="tag">&lt;/<span class="name">a</span>&gt;</span>    </span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:;&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;addGoodsToCar()&quot;</span>&gt;</span>加入购物车<span class="tag">&lt;/<span class="name">a</span>&gt;</span>            </span><br><span class="line">                <span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">&quot;$&#123;user.username ==&#x27;admin&#x27; &#125;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;$&#123;ctx &#125;/goods?op=toUpdate&amp;gid=$&#123;goods.gid&#125;&quot;</span>&gt;</span>更新<span class="tag">&lt;/<span class="name">a</span>&gt;</span> </span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">c:forEach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="comment">/*js的方式*/</span></span></span><br><span class="line"><span class="javascript">     <span class="function"><span class="keyword">function</span> <span class="title">addGoodsToCar</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> a=event.target;<span class="comment">//获取点击对象的事件源</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> num=a.parentElement.previousElementSibling.firstElementChild;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> gid=num.parentElement.previousElementSibling;</span></span><br><span class="line"><span class="javascript">        location=<span class="string">&quot;$&#123;ctx&#125;/goods?op=addGoodsToCar&amp;gid=&quot;</span>+gid.innerHTML+<span class="string">&quot;&amp;num=&quot;</span>+num.value;</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>GoodsServlet</li>
</ul>
<p>用户点击加入购物车，将gid保存到Map&lt;Integer, List<GoodDetail>&gt; map中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addGoodsToCar</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> gid =Integer.parseInt(req.getParameter(<span class="string">&quot;gid&quot;</span>));</span><br><span class="line">    <span class="keyword">int</span> num =Integer.parseInt(req.getParameter(<span class="string">&quot;num&quot;</span>));</span><br><span class="line">    User user = (User) req.getSession().getAttribute(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">    <span class="keyword">int</span> uid = user.getUid();</span><br><span class="line">    Detail d=<span class="keyword">new</span> Detail(num, gid);</span><br><span class="line">    List&lt;Detail&gt; goodList = shopCar.get(uid);<span class="comment">//根据uid获取个人购物车List</span></span><br><span class="line">    <span class="keyword">if</span>(goodList==<span class="keyword">null</span>)&#123;<span class="comment">//如果不存在List，说明是第一次添加商品到购物车</span></span><br><span class="line">        goodList=<span class="keyword">new</span> ArrayList&lt;Detail&gt;();<span class="comment">//创建购物车List        </span></span><br><span class="line">        shopCar.put(uid, goodList);<span class="comment">//将购物车放到Map中</span></span><br><span class="line">    &#125;</span><br><span class="line">    goodList.add(d);<span class="comment">//添加商品到购物车</span></span><br><span class="line">    list(req, resp);<span class="comment">//调用显示商品列表信息的方法，回到到商品信息列表页面</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="订单"><a href="#订单" class="headerlink" title="订单"></a>订单</h2><h3 id="添加订单"><a href="#添加订单" class="headerlink" title="添加订单"></a>添加订单</h3><p>思路：</p>
<p>1、生成uuid作为订单编号，并插入订单记录</p>
<p>2、将List<Detail>中的订单项循环加入到数据库</p>
<ul>
<li>OrderDaoImpl</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">insertOrder</span><span class="params">(List&lt;Detail&gt; list, Gorder gorder)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> result=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        JdbcUtils.startTransaction();<span class="comment">//开启事务</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//TODO 插入订单</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//TODO 循环插入订单详情</span></span><br><span class="line"></span><br><span class="line">        JdbcUtils.commit();<span class="comment">//提交事务</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        JdbcUtils.rollback();<span class="comment">//回滚事务</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;<span class="comment">//如果插入失败，则返回0</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;<span class="comment">//返回最后结果</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>OrderServlet</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">order</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    <span class="comment">//TODO 从ServletContext域对象中获取用户的购物车商品信息</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//TODO 获取uid</span></span><br><span class="line"></span><br><span class="line">    String oid=UUIDUtils.uuid();<span class="comment">//订单编号</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//循环给订单项添加订单编号</span></span><br><span class="line">    List&lt;Detail&gt; list = shopCar.get(uid);</span><br><span class="line">    <span class="keyword">for</span> (Detail detail : list) &#123;</span><br><span class="line">        detail.setOid(oid);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//TODO 调用service层</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//判断返回值    </span></span><br><span class="line">    <span class="keyword">if</span>(result==<span class="number">0</span>)&#123;</span><br><span class="line">        resp.getWriter().write(<span class="string">&quot;&lt;script&gt;alert(&#x27;下单失败&#x27;);history.go(-1)&lt;/script&gt;&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        resp.getWriter().write(<span class="string">&quot;&lt;script&gt;alert(&#x27;下单成功&#x27;);location=&#x27;/goods?op=list&#x27;&lt;/script&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意：订单编号：使用uuid来代替</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">uuid</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> UUID.randomUUID().toString().replaceAll(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="支付订单"><a href="#支付订单" class="headerlink" title="支付订单"></a>支付订单</h3><p>思路：</p>
<p>1、根据用户编号和金额，修改余额</p>
<p>2、根据订单编号修改订单状态</p>
<p>3、根据订单编号选出所有商品</p>
<p>4、循环修改商品库存</p>
<p>5、修改Session中User的余额</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/11/17/day11_shop/shop/" data-id="ckdvnr2od000nhv5dcgbph2kg" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%B8%AD%E7%BA%A7%E6%B5%8B%E8%AF%95/" rel="tag">中级测试</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-day12_ajax/ajax" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/17/day12_ajax/ajax/" class="article-date">
  <time datetime="2017-11-17T07:51:58.000Z" itemprop="datePublished">2017-11-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/java%E4%B8%AD%E7%BA%A7%E5%9F%BA%E7%A1%80/">java中级基础</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/17/day12_ajax/ajax/">ajax技术</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="目前问题"><a href="#目前问题" class="headerlink" title="目前问题"></a>目前问题</h2><ol>
<li>数据重写填写</li>
<li>页面内容重新获取</li>
<li>不能局部修改页面的内容</li>
<li>等待过程中无法操作页面（同步）</li>
</ol>
<h2 id="ajax"><a href="#ajax" class="headerlink" title="ajax"></a>ajax</h2><p>概念：Asynchronous Javascript And Xml  异步javascript和xml(数据)</p>
<p>作用：不用刷新页面就可以修改页面内容</p>
<p>特点：<br>1、异步请求数据<br>2、dom编程（局部修改数据）</p>
<h2 id="ajax入门"><a href="#ajax入门" class="headerlink" title="ajax入门"></a>ajax入门</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1、创建对象XMLHttpRequest</span></span><br><span class="line"><span class="keyword">var</span> xmlhttp=<span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line"><span class="comment">//2、请求</span></span><br><span class="line">xmlhttp.open(<span class="string">&quot;请求方式&quot;</span>,<span class="string">&quot;请求地址&quot;</span>,<span class="literal">true</span>);</span><br><span class="line">xmlhttp.send();</span><br><span class="line"><span class="comment">//3、处理、回调</span></span><br><span class="line">xmlhttp.onreadystatechange=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (xmlhttp.readyState==<span class="number">4</span> &amp;&amp; xmlhttp.status==<span class="number">200</span>)&#123;<span class="comment">//判断状态</span></span><br><span class="line">        <span class="comment">//处理数据</span></span><br><span class="line">        <span class="built_in">document</span>.getElementById(<span class="string">&quot;myDiv&quot;</span>).innerHTML=xmlhttp.responseText;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ajax请求与发送数据"><a href="#ajax请求与发送数据" class="headerlink" title="ajax请求与发送数据"></a>ajax请求与发送数据</h2><p><img src="http://oyirtj6m7.bkt.clouddn.com/17-11-17/24997929.jpg"></p>
<h2 id="ajax工具类封装"><a href="#ajax工具类封装" class="headerlink" title="ajax工具类封装"></a>ajax工具类封装</h2><ul>
<li>type:请求类型</li>
<li>url:请求地址</li>
<li>data:发送数据</li>
<li>dataType:返回的数据类型</li>
<li>success:成功时执行的方法</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建工具类</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ajax</span>(<span class="params">option</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//创建对象</span></span><br><span class="line">    <span class="keyword">var</span> xmlhttp = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    xmlhttp.open(option.type, option.url, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">//不同的请求方式，执行不同的方法</span></span><br><span class="line">    <span class="keyword">if</span>(option.type==<span class="string">&quot;get&quot;</span>)&#123;</span><br><span class="line">        xmlhttp.send();</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(option.type==<span class="string">&quot;post&quot;</span>)&#123;</span><br><span class="line">        xmlhttp.setRequestHeader(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span><br><span class="line">        xmlhttp.send(option.data);</span><br><span class="line">    &#125;        </span><br><span class="line">    xmlhttp.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//成功</span></span><br><span class="line">        <span class="keyword">if</span> (xmlhttp.readyState == <span class="number">4</span> &amp;&amp; xmlhttp.status == <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="comment">//不同的数据类型，执行不同的方法</span></span><br><span class="line">            <span class="keyword">if</span>(option.dataType==<span class="string">&quot;text&quot;</span>)&#123;</span><br><span class="line">                option.success(xmlhttp.responseText);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(option.dataType==<span class="string">&quot;script&quot;</span>)&#123;</span><br><span class="line">                option.success(xmlhttp.responseText);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(option.dataType==<span class="string">&quot;json&quot;</span>)&#123;</span><br><span class="line">                <span class="keyword">var</span> json=<span class="built_in">eval</span>(<span class="string">&quot;(&quot;</span>+xmlhttp.responseText+<span class="string">&quot;)&quot;</span>);</span><br><span class="line">                option.success(json);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(option.dataType==<span class="string">&quot;xml&quot;</span>)&#123;</span><br><span class="line">                option.success(xmlhttp.responseXML);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用工具类</span></span><br><span class="line">ajax(&#123;</span><br><span class="line">    type:<span class="string">&quot;get&quot;</span>,</span><br><span class="line">    url:<span class="string">&quot;/ajax/ajax?op=json3&quot;</span>,</span><br><span class="line">    dataType:<span class="string">&quot;json&quot;</span>,</span><br><span class="line">    success:<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(i <span class="keyword">in</span> data)&#123;<span class="comment">//i就是下标</span></span><br><span class="line">            content.innerHTML=content.innerHTML+data[i].username+<span class="string">&quot;,&quot;</span>+data[i].password+<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/11/17/day12_ajax/ajax/" data-id="ckdvnr2oe000phv5d6w3r0cq9" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-day13_mybatis/mybatis" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/17/day13_mybatis/mybatis/" class="article-date">
  <time datetime="2017-11-17T07:51:58.000Z" itemprop="datePublished">2017-11-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/java%E9%AB%98%E7%BA%A7/">java高级</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/17/day13_mybatis/mybatis/">mybatis</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="mybatis的概念"><a href="#mybatis的概念" class="headerlink" title="mybatis的概念"></a>mybatis的概念</h2><ul>
<li><p>概念：一个持久层框架</p>
</li>
<li><p>作用：ORM将sql语句映射成实体类</p>
</li>
<li><p>特点：</p>
</li>
</ul>
<ol>
<li>巧灵活</li>
<li>半自动化，面向sql</li>
<li>使用与中小型项目的开发</li>
</ol>
<h2 id="mybatis入门"><a href="#mybatis入门" class="headerlink" title="mybatis入门"></a>mybatis入门</h2><p><img src="http://oyirtj6m7.bkt.clouddn.com/17-11-17/18091072.jpg"></p>
<p>1、创建mybatis-config.xml文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">  <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">  <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/bank?useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=utf-8&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2、创建映射文件UserMapper.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">  <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">  <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUser&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.hemi.mybatis.bean.User&quot;</span>&gt;</span></span><br><span class="line">          select * from user where uid=1;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br><span class="line">  </span><br></pre></td></tr></table></figure>
<p>3、获取xml配置文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">InputStream inputStream = Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>4、创建SqlSessionFactory</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SqlSessionFactory factory=<span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br></pre></td></tr></table></figure>

<p>5、获取SqlSession</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SqlSession sqlSession = factory.openSession();</span><br></pre></td></tr></table></figure>

<p>6、调用SqlSession的selectOne(命名空间.id名称);</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Object object = sqlSession.selectOne(<span class="string">&quot;user.selectUser&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>7、关闭SqlSession</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlSession.close();</span><br></pre></td></tr></table></figure>

<h2 id="xml配置文件详解"><a href="#xml配置文件详解" class="headerlink" title="xml配置文件详解"></a>xml配置文件详解</h2><p>1、databaseIdProvider</p>
<p>通过数据库别名判断使用哪个sql语句</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置数据库别名 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">databaseIdProvider</span> <span class="attr">type</span>=<span class="string">&quot;DB_VENDOR&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;SQL Server&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sqlserver&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;DB2&quot;</span> <span class="attr">value</span>=<span class="string">&quot;db2&quot;</span>/&gt;</span>        </span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;Oracle&quot;</span> <span class="attr">value</span>=<span class="string">&quot;oracle&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;MySQL&quot;</span> <span class="attr">value</span>=<span class="string">&quot;mysql&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">databaseIdProvider</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- mybatis会自动根据当前使用的数据库，筛选出对应databaseId的sql语句 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span> <span class="attr">databaseId</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">    select * from user where uid=#&#123;value&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2、properties 加载配置文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- resource:加载配置文件，如果resource有值，property标签也有值，那么以resource为主 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- url：可以加载本地文件，或者网络文件，例如url=&quot;file:///d:db.properties&quot;--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;db.properties&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbc.driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3、settings 全局配置信息</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;LOG4J&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>4、typeAliases 类型别名</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 指定某个类的别名 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">&quot;com.mybatis.bean.User&quot;</span> <span class="attr">alias</span>=<span class="string">&quot;User&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 自动扫描某个包下的所有类，默认将类名的大（小）写作为别名 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.mybatis.bean&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>5、typeHandler 类型处理器</p>
<p>详解见mybatis官方文档 <a target="_blank" rel="noopener" href="http://www.mybatis.org/mybatis-3/zh/configuration.html#typeHandlers" title="mybatis官方文档">mybatis官方文档</a></p>
<p>凡是mybatis内置的类型处理器有的，都可以使用相对于的别名，或者不用写。使用#{value}来取值</p>
<p>例如：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- int输入类型有对应类型处理器处理，所以可以不用写parameterType输入映射 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">      select * from user where uid=#&#123;value&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>


<h2 id="增删改"><a href="#增删改" class="headerlink" title="增删改"></a>增删改</h2><h3 id="增"><a href="#增" class="headerlink" title="增"></a>增</h3><p><img src="http://oyirtj6m7.bkt.clouddn.com/17-11-17/70004548.jpg"></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.hemi.mybatis.bean.User&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 通过#&#123;属性名&#125;来获取对象的值 --&gt;</span></span><br><span class="line">      insert into user (username,password) values(#&#123;username&#125;,#&#123;password&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">      </span><br><span class="line">      </span><br></pre></td></tr></table></figure>
<h3 id="改"><a href="#改" class="headerlink" title="改"></a>改</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.hemi.mybatis.bean.User&quot;</span>&gt;</span></span><br><span class="line">      update user set username=#&#123;username&#125;,password=#&#123;password&#125; where uid=#&#123;uid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="删"><a href="#删" class="headerlink" title="删"></a>删</h3><p><img src="http://oyirtj6m7.bkt.clouddn.com/17-11-17/99501639.jpg"></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">      delete from user where uid=#&#123;value&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>


<h2 id="Mapper接口开发"><a href="#Mapper接口开发" class="headerlink" title="Mapper接口开发"></a>Mapper接口开发</h2><p>一、定义一个接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TypeMapper</span> </span>&#123;</span><br><span class="line">    <span class="function">Type <span class="title">selectType</span><span class="params">(<span class="keyword">int</span> typeid)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>二、定义一个mapper.xml映射文件</p>
<p>mapper文件的要求：</p>
<ol>
<li>namespace的值就是对象接口的全类名，并且类名和xml文件名保持一致</li>
<li>id的值就是抽象方法</li>
<li>resultType的值必须和抽象方法的返回值一致</li>
<li>parameterType的值和抽象方法的参数类型一致</li>
</ol>
<p><strong>注意</strong><br>mapper.xml文件的约束是mapper.dtd，不是config.dtd</p>
<p>三、使用</p>
<p>将mybatis入门步骤中的步骤六改为如下代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TypeMapper mapper=sqlSession.getMapper(TypeMapper.class);</span><br><span class="line">Type type=mapper.selectType(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h2 id="动态sql"><a href="#动态sql" class="headerlink" title="动态sql"></a>动态sql</h2><h3 id="if"><a href="#if" class="headerlink" title="if"></a>if</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM good INNER JOIN type ON good.type = type.typeid where 1=1</span><br><span class="line">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;gname !=null and gname !=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">    and gname like concat(&#x27;%&#x27;,#&#123;gname&#125;,&#x27;%&#x27;)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>注意：</p>
<p>1、字符串的拼接建议使用concat来代替<code>$&#123;&#125;</code></p>
<p>2、判断条件中获取数据不用加#{}，与el表达式不一样</p>
<p>###　where</p>
<p>作用where可以自动去除第一个and</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;gname !=null and gname !=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">      and gname like concat(&#x27;%&#x27;,#&#123;gname&#125;,&#x27;%&#x27;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;typename !=null and typename!=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">      and typename like concat(&#x27;%&#x27;,#&#123;typename&#125;,&#x27;%&#x27;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br></pre></td></tr></table></figure>


<h3 id="choose-when-otherwise"><a href="#choose-when-otherwise" class="headerlink" title="choose when otherwise"></a>choose when otherwise</h3><p>作用：组合使用，相当于if else if else</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findActiveBlogLike&quot;</span></span></span><br><span class="line"><span class="tag">     <span class="attr">resultType</span>=<span class="string">&quot;Blog&quot;</span>&gt;</span></span><br><span class="line">  SELECT * FROM BLOG WHERE state = &#x27;ACTIVE&#x27;</span><br><span class="line">  <span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;title != null&quot;</span>&gt;</span></span><br><span class="line">      AND title like #&#123;title&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;author != null and author.name != null&quot;</span>&gt;</span></span><br><span class="line">      AND author_name like #&#123;author.name&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">otherwise</span>&gt;</span></span><br><span class="line">      AND featured = 1</span><br><span class="line">    <span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="set"><a href="#set" class="headerlink" title="set"></a>set</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">update good </span><br><span class="line">   <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;gname!=null and gname!=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">        gname=#&#123;gname&#125;,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;gprice!=null and gprice!=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">        gprice=#&#123;gprice&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">where gid=#&#123;gid&#125;</span><br></pre></td></tr></table></figure>

<p>###　trim </p>
<p>作用：去除多余字符串</p>
<p>两种常见的用法</p>
<p>1、where and</p>
<p>prefix:字首<br>prefixOverrides：去除第一个指定的字符串</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">select * from good</span><br><span class="line"><span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">&quot;where&quot;</span> <span class="attr">prefixOverrides</span>=<span class="string">&quot;and|or&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--添加where在前面，并且去除第一个and--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;gname !=null and gname !=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">    and gname like concat(&#x27;%&#x27;,#&#123;gname&#125;,&#x27;%&#x27;)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;typename !=null and typename!=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">    and typename like concat(&#x27;%&#x27;,#&#123;typename&#125;,&#x27;%&#x27;)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2、set ,</p>
<p>prefix：字首<br>suffixOverrides：去除最后指定的字符串</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">update good </span><br><span class="line"><span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">&quot;set&quot;</span> <span class="attr">suffixOverrides</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--添加set在前面，并且去除最后一个,--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;gname!=null and gname!=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">      gname=#&#123;gname&#125;,</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;gprice!=null and gprice!=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">      gprice=#&#123;gprice&#125;,</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br></pre></td></tr></table></figure>


<h3 id="foreach"><a href="#foreach" class="headerlink" title="foreach"></a>foreach</h3><p>作用：动态循环拼接sql部分内容</p>
<p>1、open代表在集合前面添加的字符串</p>
<p>2、close代表在集合后面添加的字符串</p>
<p>3、separator代表集合分割使用的字符串</p>
<p>4、collection代表被循环的集合，值可以是list、map、array</p>
<p>5、常见用法，in的语句</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectGoodByGid&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;list&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Good&quot;</span>&gt;</span></span><br><span class="line">    select gid,gname,gprice,count,type typeid from good</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">      gid in</span><br><span class="line">      </span><br><span class="line">      <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">item</span>=<span class="string">&quot;item&quot;</span> <span class="attr">collection</span>=<span class="string">&quot;list&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span>&gt;</span></span><br><span class="line">             #&#123;item&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="resultMap"><a href="#resultMap" class="headerlink" title="resultMap"></a>resultMap</h2><h3 id="作用："><a href="#作用：" class="headerlink" title="作用："></a>作用：</h3><p>1、可以将表字段与javabean对象属性名进行映射<br>2、将映射抽取出来，可以给多个statement所使用</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- type:最终返回的数据类型  id:resultMap的名称 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Good&quot;</span> <span class="attr">id</span>=<span class="string">&quot;GoodResultMap&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 建议将主键设置为id --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;good_id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;gid&quot;</span>/&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 通过result将数据库字段与java对象的属性进行一一映射 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;good_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;gname&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;good_price&quot;</span> <span class="attr">property</span>=<span class="string">&quot;gprice&quot;</span>/&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        下面的映射可以不用写，因为mybatis中默认设置autoMappingBehavior为PARTIAL，局部自动映射，但是属性名必须和字段名一致</span></span><br><span class="line"><span class="comment">      --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- &lt;result column=&quot;count&quot; property=&quot;count&quot;/&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="映射的原理"><a href="#映射的原理" class="headerlink" title="映射的原理"></a>映射的原理</h3><p>1、先拿到type指定的类的class</p>
<p>2、通过newInstance创建对象</p>
<p>3、获取property中属性名，通过反射的方式调用对应的set()方法</p>
<p>4、调用方法的invoke()方法，将column的值赋值进去</p>
<p>5、返回封装好的对象</p>
<h3 id="关联嵌套结果（resultMap与resultMap相互嵌套）"><a href="#关联嵌套结果（resultMap与resultMap相互嵌套）" class="headerlink" title="关联嵌套结果（resultMap与resultMap相互嵌套）"></a>关联嵌套结果（resultMap与resultMap相互嵌套）</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Good&quot;</span> <span class="attr">id</span>=<span class="string">&quot;GoodResultMap&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;good_id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;gid&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;good_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;gname&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;good_price&quot;</span> <span class="attr">property</span>=<span class="string">&quot;gprice&quot;</span>/&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 一对一的映射关系，选择association --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 内部嵌套 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;type&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;Type&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;typeid&quot;</span> <span class="attr">property</span>=<span class="string">&quot;typeid&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;typename&quot;</span> <span class="attr">property</span>=<span class="string">&quot;typename&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>上面的association部分可以改造为<code>&lt;association property=&quot;type&quot; javaType=&quot;Type&quot; resultMap=&quot;TypeResultMap&quot;&gt;</code>，然后使用外部嵌套</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- resultMap外部嵌套 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Type&quot;</span> <span class="attr">id</span>=<span class="string">&quot;TypeResultMap&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 建议将主键设置为id --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;typeid&quot;</span> <span class="attr">property</span>=<span class="string">&quot;typeid&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;typename&quot;</span> <span class="attr">property</span>=<span class="string">&quot;typename&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="关联嵌套查询"><a href="#关联嵌套查询" class="headerlink" title="关联嵌套查询"></a>关联嵌套查询</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Good&quot;</span> <span class="attr">id</span>=<span class="string">&quot;GoodResultMap1&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;good_id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;gid&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;good_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;gname&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;good_price&quot;</span> <span class="attr">property</span>=<span class="string">&quot;gprice&quot;</span>/&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--column：要传递给下面的statement的参数--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--javaType：该association返回的数据类型--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--select：另一个查询语句的statementId--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;type&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;Type&quot;</span> <span class="attr">select</span>=<span class="string">&quot;selectTypeByTypeId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;type&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectTypeByTypeId&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Type&quot;</span>&gt;</span></span><br><span class="line">  select * from type where typeid=#&#123;value&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="集合嵌套结果"><a href="#集合嵌套结果" class="headerlink" title="集合嵌套结果"></a>集合嵌套结果</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">colleciton</span> <span class="attr">property</span>=<span class="string">&quot;javabean中的属性名&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;List&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;list集合中的元素类型&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;主键字段名&quot;</span> <span class="attr">property</span>=<span class="string">&quot;元素类型的属性名&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;字段名&quot;</span> <span class="attr">property</span>=<span class="string">&quot;元素类型的属性名&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">colleciton</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="集合嵌套查询"><a href="#集合嵌套查询" class="headerlink" title="集合嵌套查询"></a>集合嵌套查询</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">colleciton</span> <span class="attr">property</span>=<span class="string">&quot;javabean中的属性名&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;List&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;list集合中的元素类型&quot;</span> <span class="attr">select</span>=<span class="string">&quot;selectUser&quot;</span> <span class="attr">column</span>=<span class="string">&quot;uid&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUser&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">  select * from user where uid=#&#123;value&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注意：</p>
<p>如果在主配置文件中配置了</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 虽然默认是 PARTIAL，但是建议写上--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;autoMappingBehavior&quot;</span> <span class="attr">value</span>=<span class="string">&quot;PARTIAL&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h2><h3 id="一级缓存"><a href="#一级缓存" class="headerlink" title="一级缓存"></a>一级缓存</h3><p>同一个SqlSession，执行相同的sql语句，先找缓存</p>
<p>默认开启</p>
<h3 id="二级缓存"><a href="#二级缓存" class="headerlink" title="二级缓存"></a>二级缓存</h3><p>同一个namespace下的不同的SqlSession，执行相同的sql语句，先找缓存</p>
<p>配置<br>1、setting中设置cacheEnabled=”true”</p>
<p>2、mapper中添加<cache/>标签</p>
<p>3、statement中添加useCache=”true”</p>
<p>4、对需要缓存的对象需要序列化</p>
<p>4、调用session.close()时候才将数据写入二级缓存</p>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>1、通过Jdk动态代理方式创建出Mapper接口的代理对象<br>2、有一个实现了InvocationHandler的MapperProxy类，可以获取被代理对象注解上的sql语句，或者获取对应xml文件中的sql语句，然后通过jdbc实现对数据库的增删改查操作</p>
<h2 id="mybatis-plus"><a href="#mybatis-plus" class="headerlink" title="mybatis-plus"></a>mybatis-plus</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.baomidou.mybatisplus.spring.MybatisSqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 自动扫描Mapping.xml文件 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mapperLocations&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath*:/mapper/*.xml&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--扫描实体类--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;typeAliasesPackage&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.study.entity&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--mybatis-plus全局配置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;globalConfig&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;globalConfig&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- MP 全局配置 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;globalConfig&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.baomidou.mybatisplus.entity.GlobalConfiguration&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--主键为自增长--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;idType&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--下划线转驼峰命名--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dbColumnUnderline&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- MyBatis 动态实现  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;mapperScannerConfigurer&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 对Dao 接口动态实现，需要知道接口在哪  --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basePackage&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.study.mapper&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/11/17/day13_mybatis/mybatis/" data-id="ckdvnr2og000vhv5dadxt4p0l" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8C%81%E4%B9%85%E5%8C%96%E6%A1%86%E6%9E%B6-mybatis/" rel="tag">持久化框架 mybatis</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-day14_spring/spring-aop" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/17/day14_spring/spring-aop/" class="article-date">
  <time datetime="2017-11-17T07:51:58.000Z" itemprop="datePublished">2017-11-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/java%E9%AB%98%E7%BA%A7/">java高级</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/17/day14_spring/spring-aop/">spring-aop</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="aop概念"><a href="#aop概念" class="headerlink" title="aop概念"></a>aop概念</h2><p>概念：面向切面编程</p>
<p>作用：不用修改原来的类就可以添加新功能</p>
<h2 id="aop术语"><a href="#aop术语" class="headerlink" title="aop术语"></a>aop术语</h2><ul>
<li>joinpoint 连接点：类中可以被增强的方法（其实就是类中的方法）</li>
<li>pointcut 切入点：类中实际被增强的方法（并不是所有的方法都被增强了）</li>
<li>advice 通知/增强：实际扩展功能的逻辑，有下面几种类型<ul>
<li>before 前置增强：方法执行之前</li>
<li>after-returning 后置增强：方法正常执行之后，如果出现异常，则不能增强</li>
<li>after-throwing 异常增强：出现异常的时候</li>
<li>after 最终增强：一定会执行的增强，无论是否出现异常，相当于finally代码块</li>
<li>around 环绕增强：方法之前和之后执行</li>
</ul>
</li>
<li>aspect 切面：把增强用到切入点的过程</li>
<li>target 目标：被增强方法所在的类</li>
<li>weaving 织入：将增强应用到目标的过程</li>
</ul>
<h2 id="AOP实现方式"><a href="#AOP实现方式" class="headerlink" title="AOP实现方式"></a>AOP实现方式</h2><p>Spring实现aop操作有两种方式：</p>
<p>1、Spring-aop<br>2、AspectJ</p>
<h3 id="1、spring-aop-使用xml文件实现AOP"><a href="#1、spring-aop-使用xml文件实现AOP" class="headerlink" title="1、spring-aop(使用xml文件实现AOP)"></a>1、spring-aop(使用xml文件实现AOP)</h3><p><strong>使用步骤</strong></p>
<p>1、导包</p>
<p>spring-aop.jar、aspectjweaver.jar</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 被增强的类 --&gt;</span>                </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.hemi.bean.Car&quot;</span> <span class="attr">id</span>=<span class="string">&quot;car&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 实施增强的类 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.hemi.bean.CarUtils&quot;</span> <span class="attr">id</span>=<span class="string">&quot;carUtils&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 配置aop --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span>    </span><br><span class="line">        <span class="comment">&lt;!-- 切入点：被增强的方法 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">&quot;execution(public void com.hemi.bean.Car.run(..))&quot;</span> <span class="attr">id</span>=<span class="string">&quot;pointcut1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 切面:将切面运用到切入点的过程 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;carUtils&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">&quot;show&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pointcut1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>标签详解</strong></p>
<p><img src="http://oyirtj6m7.bkt.clouddn.com/17-11-17/93026255.jpg"></p>
<h3 id="2、AspectJ-使用注解实现AOP"><a href="#2、AspectJ-使用注解实现AOP" class="headerlink" title="2、AspectJ(使用注解实现AOP)"></a>2、AspectJ(使用注解实现AOP)</h3><p><strong>使用步骤</strong></p>
<p>1、导包<br>spring-aspects.jar、aspectjweaver.jar</p>
<p>2、通过xml文件开启aspectj注解</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>3、创建增强类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span><span class="comment">//1、标示该类是增强类</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentUtils</span> </span>&#123;</span><br><span class="line">    <span class="comment">//2、配置切入点，括号内是表达式</span></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.hemi.bean.Student.study(..))&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pointcut</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//3、前置增强，括号内写切入点的名称，即上面的方法名</span></span><br><span class="line">    <span class="meta">@Before(&quot;pointcut()&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">high</span><span class="params">(Joinpoint jp)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;玩会手机。。。。&quot;</span>);</span><br><span class="line">        jp.getArgs();<span class="comment">//获取参数</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;pointcut()&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">(ProceddingJoinpointcut pjp)</span></span>&#123;<span class="comment">//ProceddingJoinpointcut只有在环绕增强时可以用</span></span><br><span class="line">        pjp.getSignature().getDeclaringType();<span class="comment">//获取方法名</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>注解详解</strong></p>
<p><img src="http://oyirtj6m7.bkt.clouddn.com/17-11-17/46214108.jpg"></p>
<p><strong>重点关注</strong></p>
<ul>
<li>@After</li>
</ul>
<p><img src="http://oyirtj6m7.bkt.clouddn.com/17-11-17/6369858.jpg"></p>
<ul>
<li>@AfterThrowing</li>
</ul>
<p><img src="http://oyirtj6m7.bkt.clouddn.com/17-11-17/40815456.jpg"></p>
<ul>
<li>@Around</li>
</ul>
<p><img src="http://oyirtj6m7.bkt.clouddn.com/17-11-17/24007427.jpg"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/11/17/day14_spring/spring-aop/" data-id="ckdvnr2ok0015hv5d0mkq8vhd" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring-aop/" rel="tag">spring aop</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-day14_spring/spring-transaction" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/17/day14_spring/spring-transaction/" class="article-date">
  <time datetime="2017-11-17T07:51:58.000Z" itemprop="datePublished">2017-11-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/java%E9%AB%98%E7%BA%A7/">java高级</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/17/day14_spring/spring-transaction/">spring事务</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h2><h3 id="回顾知识"><a href="#回顾知识" class="headerlink" title="回顾知识"></a>回顾知识</h3><p>1、什么是事务</p>
<p>事务逻辑上的一组操作,组成这组操作的各个逻辑单元,要么一起成功,要么一起失败.</p>
<p>2、事务特性:ACID</p>
<ul>
<li>原子性    :强调事务的不可分割.</li>
<li>一致性    :事务的执行的前后数据的完整性保持一致(转账).</li>
<li>隔离性    :一个事务执行的过程中,不应该受到其他事务的干扰</li>
<li>持久性    :事务一旦结束,数据就持久到数据库</li>
</ul>
<p>3、如果不考虑隔离性将会引发下面的安全性问题</p>
<ul>
<li>脏读            :一个事务读到了另一个事务的未提交commit的数据</li>
<li>不可重复读    :一个事务读到了另一个事务已经提交的update的数据导致多次查询结果不一致</li>
<li>虚读（幻读）    :一个事务读到了另一个事务已经提交的insert的数据导致多次查询结果不一致</li>
</ul>
<p>4、解决读问题:设置事务隔离级别（每种数据库的隔离级别不一样）</p>
<ul>
<li>未提交读    :脏读，不可重复读，虚读都有可能发生</li>
<li>已提交读    :避免脏读。但是不可重复读和虚读有可能发生(sqlserver,orcale)</li>
<li>可重复读    :避免脏读和不可重复读.但是虚读有可能发生（mysql）</li>
<li>串行化的    :避免以上所有读问题</li>
</ul>
<h3 id="1、使用Aspectj注解方式解决事务问题"><a href="#1、使用Aspectj注解方式解决事务问题" class="headerlink" title="1、使用Aspectj注解方式解决事务问题"></a>1、使用Aspectj注解方式解决事务问题</h3><p>1、添加约束文档</p>
<p><a target="_blank" rel="noopener" href="http://www.springframework.org/schema/tx">http://www.springframework.org/schema/tx</a> <a target="_blank" rel="noopener" href="http://www.springframework.org/schema/tx/spring-tx.xsd">http://www.springframework.org/schema/tx/spring-tx.xsd</a></p>
<p>2、xml配置事务管理器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 开启事务：通过aop的方式，对方法进行事务的增强 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>1、在任意希望进行事务增强的方法上面添加@Transactional注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMoney</span><span class="params">(<span class="keyword">int</span> uid,<span class="keyword">float</span> money,<span class="keyword">int</span> typeid)</span></span>&#123;    </span><br><span class="line">    moneyDao.getMoney(uid, money);</span><br><span class="line">    <span class="keyword">int</span> a=<span class="number">1</span>/<span class="number">0</span>;<span class="comment">//这里报错，会进行事务回滚</span></span><br><span class="line">    <span class="keyword">return</span> moneyDao.insertReocrd(<span class="keyword">new</span> Record(uid, money, typeid));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2、通过XML配置AOP方式解决事务问题"><a href="#2、通过XML配置AOP方式解决事务问题" class="headerlink" title="2、通过XML配置AOP方式解决事务问题"></a>2、通过XML配置AOP方式解决事务问题</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置AOP --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置切入点：指定哪些方法要执行事务增强 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">pointcut</span>=<span class="string">&quot;execution(* com.hemi.service.*.*(..))&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 配置增强 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 细粒度控制某个方法上事务的属性：例如事务是否传递，事务是否回滚等等 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- REQUIRED:有事务就用，没有就创建 SUPPORTS:有就用，没有就非事务执行 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- no-rollback-for:当出现了ArithmeticException异常时，也不回滚已提交的事务 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*Money&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>  <span class="attr">no-rollback-for</span>=<span class="string">&quot;ArithmeticException&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;delect*&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;update*&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;insert*&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span>        </span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;select*&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;SUPPORTS&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            isolation=&quot;DEFAULT&quot;        隔离级别</span></span><br><span class="line"><span class="comment">            propagation=&quot;REQUIRED&quot;    传播行为</span></span><br><span class="line"><span class="comment">            read-only=&quot;false&quot;    只读</span></span><br><span class="line"><span class="comment">            timeout=&quot;-1&quot;        过期时间</span></span><br><span class="line"><span class="comment">            rollback-for=&quot;&quot;        -Exception</span></span><br><span class="line"><span class="comment">            no-rollback-for=&quot;&quot;    +Exception</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>注意</strong></p>
<p>推荐使用第二种方式，可以控制所有的方法是否使用事务！</p>
<h2 id="事务补充知识点"><a href="#事务补充知识点" class="headerlink" title="事务补充知识点"></a>事务补充知识点</h2><h3 id="1、事务回滚控制"><a href="#1、事务回滚控制" class="headerlink" title="1、事务回滚控制"></a>1、事务回滚控制</h3><p>控制遇到哪些异常才要回滚事务</p>
<p><img src="http://oyirtj6m7.bkt.clouddn.com/17-11-17/82673948.jpg"></p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在需要增强的方法上面，添加该注解，就可以使用事务</span></span><br><span class="line"><span class="comment">//noRollbackFor:如果出现了ArithmeticException，忽略</span></span><br><span class="line"><span class="meta">@Transactional(noRollbackFor=&#123;ArithmeticException.class&#125;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMoney</span><span class="params">(<span class="keyword">int</span> uid, <span class="keyword">float</span> money, <span class="keyword">int</span> typeid)</span> </span>&#123;</span><br><span class="line">    moneyDao.getMoney(uid, money);</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">1</span> / <span class="number">0</span>;<span class="comment">//虽然这里抛出异常，但是上面的操作依然生效，事务不会回滚</span></span><br><span class="line">    <span class="keyword">return</span> moneyDao.insertReocrd(<span class="keyword">new</span> Record(uid, money, typeid));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其他事务属性一览表</p>
<p><img src="http://oyirtj6m7.bkt.clouddn.com/17-11-17/62052374.jpg"></p>
<h3 id="2、事务隔离级别-isolation"><a href="#2、事务隔离级别-isolation" class="headerlink" title="2、事务隔离级别 isolation"></a>2、事务隔离级别 isolation</h3><p>事务隔离概念：解决并发问题</p>
<p>不同的数据库支持不同的隔离级别，一般不用修改</p>
<h3 id="3、事务传递-propagation"><a href="#3、事务传递-propagation" class="headerlink" title="3、事务传递 propagation"></a>3、事务传递 propagation</h3><p>事务传递概念:两个方法相互嵌套，事务是否公用，例如：方法A的事务是否可以传递给方法B所使用</p>
<p>事务传递有多种情况，如下：</p>
<p><img src="http://oyirtj6m7.bkt.clouddn.com/17-11-17/23305954.jpg"></p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">事务：火车票售票点买票  非事务（正常执行）：打电话买票</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    假设 ma()为方法<span class="function">A <span class="title">mb</span><span class="params">()</span>为方法B</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    1、required:ma有事务,mb就用,ma没事务,mb自己创建</span></span><br><span class="line"><span class="function">    @Transactional</span></span><br><span class="line"><span class="function">    <span class="title">ma</span><span class="params">()</span></span>&#123;</span><br><span class="line">        mb();<span class="comment">//使用了方法ma的事务，如果ma回滚，那么mb也回滚</span></span><br><span class="line">        <span class="keyword">int</span> a=<span class="number">1</span>/<span class="number">0</span>;        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">2</span>、supports:ma有事务,mb就用,ma没事务,mb非事务执行</span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    ma()&#123;</span><br><span class="line">        mb();<span class="comment">//打电话</span></span><br><span class="line">        <span class="keyword">int</span> a=<span class="number">1</span>/<span class="number">0</span>;        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">3</span>、mandatory:ma有事务,mb就用,ma没事务,mb就报错</span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    ma()&#123;</span><br><span class="line">        mb();<span class="comment">//如果没有事务，那么这句就抛出异常</span></span><br><span class="line">        <span class="keyword">int</span> a=<span class="number">1</span>/<span class="number">0</span>;        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">4</span>、required_new:ma有事务,mb就暂停别人的事务,然后mb自己开启事务,mb执行完后,ma在恢复事务并继续执行</span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    ma()&#123;</span><br><span class="line">        update();</span><br><span class="line">        mb();</span><br><span class="line">        update();</span><br><span class="line">    &#125;</span><br><span class="line">    上面的代码运行,实际相当于下面的代码</span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    ma()&#123;</span><br><span class="line">        Connection con =connection.startTranscation();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                update()    </span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                con.rollback();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                Connection con1 =connection.startTranscation();</span><br><span class="line">                mb();</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                con1.rollback();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                insert();</span><br><span class="line">                <span class="keyword">int</span> a=<span class="number">10</span>/<span class="number">0</span>;</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                con.rollback();</span><br><span class="line">            &#125;    </span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            con.rollback();</span><br><span class="line">        &#125;    </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">5</span>、not_supported:ma有事务,mb就暂停别人的事务,然后mb非事务执行,mb执行完后,ma在恢复事务并继续执行</span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    ma()&#123;</span><br><span class="line">        update();</span><br><span class="line">        mb();</span><br><span class="line">        <span class="keyword">int</span> a=<span class="number">10</span>/<span class="number">0</span>;</span><br><span class="line">        insert();    </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">6</span>、never:ma有事务,mb就抛异常,ma没事务,mb就非事务执行</span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    ma()&#123;</span><br><span class="line">        update();</span><br><span class="line">        mb();</span><br><span class="line">        <span class="keyword">int</span> a=<span class="number">10</span>/<span class="number">0</span>;</span><br><span class="line">        insert();    </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">7</span>、nested:事务嵌套,ma有事务,mb就嵌套在别人的事务中,ma没事务,mb自己创建事务</span><br><span class="line">    ma()&#123;</span><br><span class="line">        update();</span><br><span class="line">        mb();</span><br><span class="line">        update();</span><br><span class="line">    &#125;</span><br><span class="line">    上面的代码运行,实际相当于下面的代码</span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    ma()&#123;</span><br><span class="line">        Connection con =connection.startTranscation();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                update()    </span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                con.rollback();</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//插队</span></span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                mb();</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                con.rollback();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                insert();</span><br><span class="line">                <span class="keyword">int</span> a=<span class="number">10</span>/<span class="number">0</span>;</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                con.rollback();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            con.rollback();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/11/17/day14_spring/spring-transaction/" data-id="ckdvnr2on001ghv5de02t43tn" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring-%E4%BA%8B%E5%8A%A1/" rel="tag">spring 事务</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/java%E4%B8%AD%E7%BA%A7%E5%9F%BA%E7%A1%80/">java中级基础</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java%E5%9F%BA%E7%A1%80%E5%A2%9E%E5%BC%BA/">java基础增强</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java%E9%AB%98%E7%BA%A7/">java高级</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java%E9%AB%98%E7%BA%A7%E5%A2%9E%E5%BC%BA/">java高级增强</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%85%B6%E4%BB%96/">其他</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/hibernate/" rel="tag">hibernate</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javaweb%E4%B8%89%E9%A9%BE%E9%A9%AC%E8%BD%A6/" rel="tag">javaweb三驾马车</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java%E5%9F%BA%E7%A1%80%E5%A2%9E%E5%BC%BA/" rel="tag">java基础增强</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jsp/" rel="tag">jsp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nosql-%E7%BC%93%E5%AD%98/" rel="tag">nosql 缓存</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring-aop/" rel="tag">spring aop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring-ioc/" rel="tag">spring ioc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring-jdbc/" rel="tag">spring jdbc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring-mybatis/" rel="tag">spring mybatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring-struts2-hibernate/" rel="tag">spring struts2 hibernate</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring-%E4%BA%8B%E5%8A%A1/" rel="tag">spring 事务</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/springboot/" rel="tag">springboot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/springmvc/" rel="tag">springmvc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/struts2/" rel="tag">struts2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xml%E8%A7%A3%E6%9E%90/" rel="tag">xml解析</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AD%E7%BA%A7%E6%B5%8B%E8%AF%95/" rel="tag">中级测试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%B6%E4%BB%96/" rel="tag">其他</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF/" rel="tag">前端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF-jquery/" rel="tag">前端 jquery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%89%E5%85%A8/" rel="tag">安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8C%81%E4%B9%85%E5%8C%96%E6%A1%86%E6%9E%B6-mybatis/" rel="tag">持久化框架 mybatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8C%81%E4%B9%85%E5%B1%82%E6%A1%86%E6%9E%B6/" rel="tag">持久层框架</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93-mysql/" rel="tag">数据库 mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/" rel="tag">服务器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%AB%98%E7%BA%A7%E9%A1%B9%E7%9B%AE/" rel="tag">高级项目</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/hibernate/" style="font-size: 13.33px;">hibernate</a> <a href="/tags/javascript/" style="font-size: 10px;">javascript</a> <a href="/tags/javaweb%E4%B8%89%E9%A9%BE%E9%A9%AC%E8%BD%A6/" style="font-size: 13.33px;">javaweb三驾马车</a> <a href="/tags/java%E5%9F%BA%E7%A1%80%E5%A2%9E%E5%BC%BA/" style="font-size: 16.67px;">java基础增强</a> <a href="/tags/jsp/" style="font-size: 10px;">jsp</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/nosql-%E7%BC%93%E5%AD%98/" style="font-size: 10px;">nosql 缓存</a> <a href="/tags/spring-aop/" style="font-size: 10px;">spring aop</a> <a href="/tags/spring-ioc/" style="font-size: 10px;">spring ioc</a> <a href="/tags/spring-jdbc/" style="font-size: 10px;">spring jdbc</a> <a href="/tags/spring-mybatis/" style="font-size: 10px;">spring mybatis</a> <a href="/tags/spring-struts2-hibernate/" style="font-size: 10px;">spring struts2 hibernate</a> <a href="/tags/spring-%E4%BA%8B%E5%8A%A1/" style="font-size: 10px;">spring 事务</a> <a href="/tags/springboot/" style="font-size: 10px;">springboot</a> <a href="/tags/springmvc/" style="font-size: 10px;">springmvc</a> <a href="/tags/struts2/" style="font-size: 10px;">struts2</a> <a href="/tags/xml%E8%A7%A3%E6%9E%90/" style="font-size: 10px;">xml解析</a> <a href="/tags/%E4%B8%AD%E7%BA%A7%E6%B5%8B%E8%AF%95/" style="font-size: 10px;">中级测试</a> <a href="/tags/%E5%85%B6%E4%BB%96/" style="font-size: 10px;">其他</a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 20px;">前端</a> <a href="/tags/%E5%89%8D%E7%AB%AF-jquery/" style="font-size: 13.33px;">前端 jquery</a> <a href="/tags/%E5%AE%89%E5%85%A8/" style="font-size: 10px;">安全</a> <a href="/tags/%E6%8C%81%E4%B9%85%E5%8C%96%E6%A1%86%E6%9E%B6-mybatis/" style="font-size: 10px;">持久化框架 mybatis</a> <a href="/tags/%E6%8C%81%E4%B9%85%E5%B1%82%E6%A1%86%E6%9E%B6/" style="font-size: 10px;">持久层框架</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93-mysql/" style="font-size: 10px;">数据库 mysql</a> <a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/" style="font-size: 10px;">服务器</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 10px;">设计模式</a> <a href="/tags/%E9%AB%98%E7%BA%A7%E9%A1%B9%E7%9B%AE/" style="font-size: 10px;">高级项目</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/08/05/day29_nginx/nginx/">(no title)</a>
          </li>
        
          <li>
            <a href="/2020/08/05/day31_%E9%83%A8%E7%BD%B2/%E5%8F%91%E5%B8%83%E6%96%87%E6%A1%A3/">(no title)</a>
          </li>
        
          <li>
            <a href="/2020/08/05/day30_docker/docker/">(no title)</a>
          </li>
        
          <li>
            <a href="/2020/01/21/day32_react/react/">(no title)</a>
          </li>
        
          <li>
            <a href="/2018/03/26/day28_es6/es6/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>